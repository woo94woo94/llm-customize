# COQ 질문 분석 - API 활용 가능성 평가

> 각 COQ 질문에 대해 api.json에 정의된 API를 활용하여 답변 가능 여부와 정확도를 분석합니다.

---

## [질문 1] 당월 전망한 매출과 직접이익금액 실 단위로 알려줘

### 📋 질문 정보
- **구분**: 전망
- **필요 데이터**: 당월 전망
- **PMS 메뉴**: 매출/실행원가 계획(M+3)

### ✅ API 활용 가능 여부: **가능**

### 🔍 사용 API 및 조회 로직

#### 1단계: 당월 전망 데이터 조회
**API**: `GET /api/monthly-plans`
- **목적**: 당월(현재 월) 기준 M+3 전망 데이터 조회
- **필터링**:
  - `target_month`: 현재 년월 (예: '202411')
  - `plan_ver`: 최신 버전 (또는 전체 조회 후 최신 선택)
  - `pjt_cd`: 특정 프로젝트 (옵션)
- **응답 필드**:
  - `m1_sales_amt`, `m2_sales_amt`, `m3_sales_amt`: 당월 포함 3개월 매출 전망
  - `m1_dcst_amt`, `m2_dcst_amt`, `m3_dcst_amt`: 직접원가 전망

#### 2단계: 직접이익 계산
**계산식**: 직접이익 = 매출 - 직접원가
- M1 직접이익 = `m1_sales_amt` - `m1_dcst_amt`
- M2 직접이익 = `m2_sales_amt` - `m2_dcst_amt`
- M3 직접이익 = `m3_sales_amt` - `m3_dcst_amt`

#### 3단계: 단위 변환
- 원 단위 → 실 단위 (억원, 1억원 = 100,000,000원)

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | `po_plan_mth_mgt` 테이블에 전망 데이터 저장 |
| **계산 가능성** | ⭐⭐⭐⭐⭐ (100%) | 직접이익 = 매출 - 직접원가로 계산 가능 |
| **필터링 정확도** | ⭐⭐⭐⭐☆ (90%) | 최신 plan_ver 선택 로직 필요 |
| **전체 정확도** | ⭐⭐⭐⭐⭐ (95%) | 높은 정확도로 답변 가능 |

### ⚠️ 제약사항 및 주의점
1. **최신 버전 선택**: `plan_ver` 중 최신 버전을 선택해야 함 (API에서 정렬 후 최상위 선택)
2. **당월 기준**: `target_month`가 현재 월과 일치하는 데이터 필터링 필요
3. **프로젝트 집계**: 특정 조직(사업실)의 전체 프로젝트 합계 시 별도 집계 필요
4. **단위 변환**: API 응답값이 원 단위이므로 억원 단위로 변환 필요

### 💡 구현 예시 (의사코드)

```javascript
// 1. 당월 전망 데이터 조회
const currentMonth = '202411'; // 현재 년월
const plans = await fetch('/api/monthly-plans?target_month=' + currentMonth);

// 2. 최신 plan_ver 데이터 필터링
const latestPlans = plans.sort((a, b) => b.plan_ver - a.plan_ver)[0];

// 3. 직접이익 계산
const m1DirectProfit = latestPlans.m1_sales_amt - latestPlans.m1_dcst_amt;
const m2DirectProfit = latestPlans.m2_sales_amt - latestPlans.m2_dcst_amt;
const m3DirectProfit = latestPlans.m3_sales_amt - latestPlans.m3_dcst_amt;

// 4. 억원 단위로 변환
const m1Result = m1DirectProfit / 100000000;
const m2Result = m2DirectProfit / 100000000;
const m3Result = m3DirectProfit / 100000000;
```

---

## [질문 2] M+3기준 매출 전망을 월별로 알려줘

### 📋 질문 정보
- **구분**: 전망
- **필요 데이터**: M+3 전망
- **PMS 메뉴**: 매출/실행원가 계획(M+3)
- **특이사항**: 
  - 실행 중 프로젝트: PM이 롤링한 최종 Rolling Data
  - 신규 프로젝트: 수주 가능성 기준 (확실, 가능, 유동)

### ✅ API 활용 가능 여부: **가능 (복합 조회 필요)**

### 🔍 사용 API 및 조회 로직

#### 1단계: 실행 중 프로젝트의 롤링 데이터 조회

**API 1**: `GET /api/projects`
- **필터링**: `system_sts_cd=03` (실행 상태)
- **목적**: 실행 중인 프로젝트 목록 조회

**API 2**: `GET /api/execution-plans/versions`
- **필터링**: 
  - `pjt_cd`: 각 실행 중 프로젝트 코드
  - `approval_sts_cd=10` (승인된 버전)
- **정렬**: `ver DESC` (최신 버전)
- **목적**: 각 프로젝트의 최종 롤링 버전 조회

**API 3**: `GET /api/revenue-plans`
- **필터링**:
  - `pjt_cd`: 프로젝트 코드
  - `ver`: 최종 롤링 버전
  - `std_ym`: 당월부터 +3개월
- **목적**: 월별 매출 계획 조회

#### 2단계: 신규 프로젝트의 수주 가능성별 전망 조회

**API 4**: `GET /api/projects`
- **필터링**: `system_sts_cd=01,02` (영업, 계약 상태)
- **목적**: 신규 프로젝트 목록 조회

**API 5**: `GET /api/monthly-plans`
- **필터링**:
  - `pjt_cd`: 각 신규 프로젝트 코드
  - `target_month`: 현재 월
- **목적**: 수주 가능성(확실/가능/유동) 포함된 월별 전망 조회

#### 3단계: 수주 가능성 판단 및 필터링
- **확실**: `suju_score >= 20` 또는 `biz_chk = 'Y'`
- **가능**: `15 <= suju_score < 20`
- **유동**: `suju_score < 15`

#### 4단계: 월별 매출 집계
- 실행 중 프로젝트의 롤링 데이터 + 신규 프로젝트의 전망 데이터를 월별로 합산

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 롤링 데이터 및 전망 데이터 모두 존재 |
| **계산 가능성** | ⭐⭐⭐⭐☆ (85%) | 수주 가능성 기준이 명확하지 않을 수 있음 |
| **필터링 정확도** | ⭐⭐⭐⭐☆ (80%) | 프로젝트 상태 및 수주 가능성 기준 해석 필요 |
| **전체 정확도** | ⭐⭐⭐⭐☆ (85%) | 복합 조회 및 집계 로직 구현 필요 |

### ⚠️ 제약사항 및 주의점
1. **복합 데이터 소스**: 실행 중 프로젝트는 롤링 데이터, 신규 프로젝트는 전망 데이터 사용
2. **수주 가능성 기준**: `suju_score` 또는 `biz_chk` 필드의 정확한 기준 확인 필요
3. **최종 롤링 버전**: 승인된 버전 중 최신 버전 선택 로직 필요
4. **월별 집계**: M+1, M+2, M+3의 월 계산 및 집계 로직 구현 필요

---

## [질문 3] 최근 2개년 IT사업실의 매출실적을 PBS기준으로 집계해줘

### 📋 질문 정보
- **구분**: 실적집계
- **필요 데이터**: 결산실적
- **PMS 메뉴**: 조직별 PJT손익실적(요약)

### ✅ API 활용 가능 여부: **가능**

### 🔍 사용 API 및 조회 로직

#### 1단계: IT사업실 프로젝트 조회
**API 1**: `GET /api/departments`
- **필터링**: `dept_nm` LIKE '%IT사업실%'
- **목적**: IT사업실의 부서코드(dept_cd) 조회

**API 2**: `GET /api/projects`
- **필터링**:
  - `carrying_out_dept_cd`: IT사업실 부서코드
  - `exe_begin_date_start`: 2023-01-01
  - `exe_end_date_end`: 2024-12-31
- **목적**: IT사업실이 수행한 프로젝트 목록 조회

#### 2단계: 프로젝트별 매출 실적 조회
**API 3**: `GET /api/revenue-actuals`
- **필터링**:
  - `pjt_cd`: 각 프로젝트 코드
  - `std_ym`: 2023년 1월 ~ 2024년 12월
- **목적**: 각 프로젝트의 월별 매출 실적 조회

#### 3단계: PBS 기준 집계
- 프로젝트의 `pbs_big_type_cd`, `pbs_middle_type_cd`, `pbs_small_type_cd` 기준으로 그룹화
- 매출 실적 합산

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 매출 실적 데이터 존재 |
| **계산 가능성** | ⭐⭐⭐⭐⭐ (100%) | 단순 합산으로 계산 가능 |
| **필터링 정확도** | ⭐⭐⭐⭐☆ (90%) | 조직명 필터링 및 기간 필터링 정확 |
| **전체 정확도** | ⭐⭐⭐⭐⭐ (95%) | 높은 정확도로 답변 가능 |

### ⚠️ 제약사항 및 주의점
1. **조직명 매칭**: 'IT사업실'이라는 정확한 부서명 확인 필요
2. **기간 설정**: '최근 2개년'을 2023-2024년으로 해석 (현재 2025년 기준)
3. **PBS 코드**: 프로젝트 마스터의 PBS 코드 기준으로 집계
4. **결산 완료**: 결산이 완료된 월만 집계 (pm_period_close 확인 가능)

---

## [질문 4] 당해년도 영업이익이 적자로 수주된 프로젝트를 알려줘

### 📋 질문 정보
- **구분**: 실적집계
- **필요 데이터**: 최초계약정보
- **PMS 메뉴**: PJT종합정보

### ✅ API 활용 가능 여부: **가능**

### 🔍 사용 API 및 조회 로직

#### 1단계: 당해년도 수주 프로젝트 조회
**API 1**: `GET /api/projects`
- **필터링**:
  - `order_de_start`: 2025-01-01
  - `order_de_end`: 2025-12-31
  - `system_sts_cd`: 02,03,04,05 (계약 이상 상태)
- **목적**: 2025년 수주된 프로젝트 목록 조회

#### 2단계: 최초계약 손익 조회
**API 2**: `GET /api/profit-loss/first-contract`
- **필터링**: `pjt_cd`: 각 프로젝트 코드
- **목적**: 최초 계약 시점의 영업이익(`oper_profit_plan_amt`) 조회

#### 3단계: 적자 프로젝트 필터링
- `oper_profit_plan_amt < 0` 조건으로 필터링

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 최초계약 손익 VIEW 존재 |
| **계산 가능성** | ⭐⭐⭐⭐⭐ (100%) | 영업이익 필드 직접 조회 가능 |
| **필터링 정확도** | ⭐⭐⭐⭐⭐ (100%) | 수주일자 및 영업이익 필터링 정확 |
| **전체 정확도** | ⭐⭐⭐⭐⭐ (100%) | 매우 높은 정확도로 답변 가능 |

### ⚠️ 제약사항 및 주의점
1. **당해년도**: 2025년 기준 (현재 시점 기준 동적 계산 필요)
2. **수주일 기준**: `order_de` 필드 기준으로 필터링
3. **적자 기준**: 영업이익 < 0

---

## [질문 5] 최근 3개월 사업실별 실매출가동율을 알려줘

### 📋 질문 정보
- **구분**: 실적집계
- **필요 데이터**: 타임카드 등록현황
- **PMS 메뉴**: 노무비 계획/실적 현황
- **특이사항**: 실매출가동율 = 매출프로젝트에 투입된 정규직 인력투입율

### ✅ API 활용 가능 여부: **가능 (복잡한 계산 필요)**

### 🔍 사용 API 및 조회 로직

#### 1단계: 사업실 목록 조회
**API 1**: `GET /api/departments`
- **필터링**: `dept_dtt_cd='실'` 또는 `dept_nm LIKE '%사업실%'`
- **목적**: 사업실 목록 조회

#### 2단계: 최근 3개월 타임카드 조회
**API 2**: `POST /api/timecards/project/search`
- **필터링**:
  - `work_de`: 최근 3개월 (예: 2025-08 ~ 2025-10)
  - `emp_dept_cd`: 각 사업실 부서코드
- **목적**: 매출 프로젝트 투입 시간 조회

**API 3**: `GET /api/timecards/non-project`
- **필터링**:
  - `work_de`: 최근 3개월
  - `dept_cd`: 각 사업실 부서코드
- **목적**: 비프로젝트(대기, 교육 등) 시간 조회

#### 3단계: 정규직 필터링
**API 4**: `GET /api/employees`
- **필터링**: 
  - `emp_no`: 타임카드에 등록된 직원번호
  - `emp_type`: 정규직 구분 코드
- **목적**: 정규직 직원만 필터링

#### 4단계: 실매출가동율 계산
**계산식**:
```
실매출가동율 = (매출프로젝트 투입시간) / (매출프로젝트 투입시간 + 비프로젝트 시간) × 100
```

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 타임카드 데이터 존재 |
| **계산 가능성** | ⭐⭐⭐☆☆ (70%) | 복잡한 집계 및 계산 로직 필요 |
| **필터링 정확도** | ⭐⭐⭐⭐☆ (80%) | 정규직 구분 기준 확인 필요 |
| **전체 정확도** | ⭐⭐⭐⭐☆ (75%) | 중간 정도의 정확도, 계산 로직 복잡 |

### ⚠️ 제약사항 및 주의점
1. **정규직 구분**: 직원 유형(emp_type) 필드의 정규직 코드 확인 필요
2. **사업실 정의**: '사업실' 부서 구분 기준 명확화 필요
3. **타임카드 집계**: 일별 타임카드를 월별, 사업실별로 집계하는 복잡한 로직 필요
4. **근무 시간 기준**: 월별 기준 근무시간(cm_work_time) 고려 필요

---

## [질문 6] 최초계약대비 직접이익율이 5%이상 증가 및 감소한 프로젝트

### 📋 질문 정보
- **구분**: 실적분석
- **필요 데이터**: 최초계약정보, 최종롤링정보
- **PMS 메뉴**: PJT종합정보

### ✅ API 활용 가능 여부: **가능**

### 🔍 사용 API 및 조회 로직

#### 1단계: 실행 중 프로젝트 조회
**API 1**: `GET /api/projects`
- **필터링**: `system_sts_cd=03` (실행 상태)
- **목적**: 실행 중인 프로젝트 목록 조회

#### 2단계: 최초계약 손익 조회
**API 2**: `GET /api/profit-loss/first-contract`
- **필터링**: `pjt_cd`: 각 프로젝트 코드
- **목적**: 최초계약 직접이익(`drct_profit_plan_amt`) 및 매출(`sales_plan_amt`) 조회
- **계산**: 최초 직접이익율 = (직접이익 / 매출) × 100

#### 3단계: 최종롤링 손익 조회
**API 3**: `GET /api/execution-plans/versions`
- **필터링**:
  - `pjt_cd`: 각 프로젝트 코드
  - `approval_sts_cd=10` (승인)
- **정렬**: `ver DESC`
- **목적**: 최종 롤링 버전 조회

**API 4**: `GET /api/profit-loss/execution-plan`
- **필터링**:
  - `pjt_cd`: 프로젝트 코드
  - `ver`: 최종 롤링 버전
- **목적**: 최종 실행원가 기준 직접이익 및 매출 조회
- **계산**: 최종 직접이익율 = (직접이익 / 매출) × 100

#### 4단계: 직접이익율 변동 계산 및 필터링
**계산식**: 
```
직접이익율 변동 = 최종 직접이익율 - 최초 직접이익율
```
**필터링**:
- 증가: 직접이익율 변동 >= 5%
- 감소: 직접이익율 변동 <= -5%

#### 5단계: 사업실별 구분
- 프로젝트의 `carrying_out_dept_cd` 기준으로 사업실 그룹화

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 최초계약 및 실행계획 손익 모두 존재 |
| **계산 가능성** | ⭐⭐⭐⭐⭐ (100%) | 직접이익율 계산 및 비교 가능 |
| **필터링 정확도** | ⭐⭐⭐⭐⭐ (95%) | 명확한 기준으로 필터링 가능 |
| **전체 정확도** | ⭐⭐⭐⭐⭐ (95%) | 매우 높은 정확도로 답변 가능 |

### ⚠️ 제약사항 및 주의점
1. **최종 롤링 버전**: 승인된 버전 중 최신 버전 선택 로직 필요
2. **직접이익율 계산**: 매출이 0인 경우 예외 처리 필요
3. **사업실 매핑**: 부서코드(dept_cd)를 사업실로 매핑하는 로직 필요

---

## [질문 7] 전월 전망한 M+1월 매출 대비 당월 매출 실적의 gap이 큰 프로젝트

### 📋 질문 정보
- **구분**: 실적분석
- **필요 데이터**: 전망자료, 결산실적
- **PMS 메뉴**: 매출/실행원가 계획(M+3), 조직별 PJT손익실적(요약)
- **특이사항**: gap = +/-1억원 이상

### ✅ API 활용 가능 여부: **가능 (복잡한 시점 비교)**

### 🔍 사용 API 및 조회 로직

#### 1단계: 전월 전망 데이터 조회
**API 1**: `GET /api/monthly-plans`
- **필터링**:
  - `target_month`: 전월 (예: 2025년 10월)
  - `plan_ver`: 최신 버전
- **목적**: 전월에 전망한 M+1월(현재 월) 매출 조회
- **사용 필드**: `m2_sales_amt` (M+1월 전망)

#### 2단계: 당월 매출 실적 조회
**API 2**: `GET /api/revenue-actuals`
- **필터링**:
  - `std_ym`: 당월 (예: 2025년 11월)
  - `pjt_cd`: 각 프로젝트 코드
- **목적**: 당월 매출 실적 조회

#### 3단계: Gap 계산 및 필터링
**계산식**:
```
Gap = 당월 실적 - 전월 M+1 전망
```
**필터링**:
- Gap >= 100,000,000 (1억원 이상)
- Gap <= -100,000,000 (-1억원 이하)

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 전망 및 실적 데이터 모두 존재 |
| **계산 가능성** | ⭐⭐⭐⭐☆ (85%) | 시점 비교 로직 구현 필요 |
| **필터링 정확도** | ⭐⭐⭐⭐☆ (85%) | 월 계산 및 버전 선택 로직 필요 |
| **전체 정확도** | ⭐⭐⭐⭐☆ (85%) | 비교적 높은 정확도, 시점 관리 중요 |

### ⚠️ 제약사항 및 주의점
1. **시점 관리**: 전월 전망의 M+1월 = 당월 개념 정확히 구현 필요
2. **최신 버전**: 전월의 최신 plan_ver 선택 로직 필요
3. **프로젝트 매칭**: 동일 프로젝트의 전망과 실적 매칭
4. **결산 완료**: 당월 결산이 완료된 경우만 정확한 비교 가능

---

## [질문 8] 최근 2개년 최초계약이익율을 사업실별/PJT Type으로 분석하고 그래프로 표현

### 📋 질문 정보
- **구분**: 실적분석
- **필요 데이터**: 최초계약정보
- **PMS 메뉴**: PJT종합정보
- **특이사항**: 그래프 표현 및 사유 분석

### ✅ API 활용 가능 여부: **데이터 조회 가능, 그래프 및 사유는 제한적**

### 🔍 사용 API 및 조회 로직

#### 1단계: 최근 2개년 계약 프로젝트 조회
**API 1**: `GET /api/projects`
- **필터링**:
  - `contract_date_start`: 2023-01-01
  - `contract_date_end`: 2024-12-31
  - `system_sts_cd`: 02,03,04,05 (계약 이상)
- **목적**: 최근 2개년 계약 프로젝트 목록 조회

#### 2단계: 최초계약 손익 조회
**API 2**: `GET /api/profit-loss/first-contract`
- **필터링**: `pjt_cd`: 각 프로젝트 코드
- **목적**: 최초계약 영업이익(`oper_profit_plan_amt`) 및 매출(`sales_plan_amt`) 조회
- **계산**: 최초계약이익율 = (영업이익 / 매출) × 100

#### 3단계: 사업실별 / PJT Type별 집계
- **사업실**: 프로젝트의 `carrying_out_dept_cd` 기준
- **PJT Type**: 프로젝트의 `pjt_type_id` 기준
- **집계**: 평균 이익율, 프로젝트 수, 총 매출 등

#### 4단계: 그래프 데이터 생성
- 데이터를 JSON 형태로 제공
- 그래프 라이브러리(Chart.js, D3.js 등)에서 활용 가능한 형태로 변환

### 📊 정확도 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **데이터 존재 여부** | ⭐⭐⭐⭐⭐ (100%) | 최초계약 손익 데이터 존재 |
| **계산 가능성** | ⭐⭐⭐⭐⭐ (100%) | 이익율 계산 및 집계 가능 |
| **필터링 정확도** | ⭐⭐⭐⭐⭐ (95%) | 기간 및 그룹화 기준 명확 |
| **그래프 표현** | ⭐⭐⭐☆☆ (60%) | API는 데이터만 제공, 그래프는 클라이언트에서 구현 |
| **사유 분석** | ⭐⭐☆☆☆ (40%) | 정량 데이터만 제공, 정성적 사유는 불가 |
| **전체 정확도** | ⭐⭐⭐⭐☆ (80%) | 데이터는 정확, 그래프 및 사유는 제한적 |

### ⚠️ 제약사항 및 주의점
1. **그래프 표현**: API는 데이터만 제공, 실제 그래프는 프론트엔드에서 구현 필요
2. **사유 분석**: 정량 데이터만 제공 가능, 정성적 사유는 LLM 추론 또는 별도 분석 필요
3. **사업실 매핑**: 부서코드를 사업실명으로 변환하는 매핑 필요
4. **PJT Type 레이블**: `pjt_type_id`를 읽기 쉬운 라벨로 변환 (공통코드 활용)

### 💡 구현 예시 (그래프 데이터 구조)

```json
{
  "categories": ["IT사업실", "EIC사업실", "Smart Factory사업실"],
  "series": [
    {
      "name": "용역(진행)",
      "data": [15.2, 18.5, 12.3]
    },
    {
      "name": "용역(확정)",
      "data": [20.1, 22.3, 19.8]
    },
    {
      "name": "정비(확정)",
      "data": [10.5, 8.7, 11.2]
    }
  ]
}
```

---

## 📈 전체 요약

### API 활용 가능성 요약표

| 질문 | 구분 | API 활용 가능성 | 정확도 | 난이도 | 비고 |
|------|------|-----------------|--------|--------|------|
| 1 | 전망 | ✅ 가능 | ⭐⭐⭐⭐⭐ 95% | 🟢 쉬움 | 직접 조회 가능 |
| 2 | 전망 | ✅ 가능 | ⭐⭐⭐⭐☆ 85% | 🟡 보통 | 복합 조회 필요 |
| 3 | 실적집계 | ✅ 가능 | ⭐⭐⭐⭐⭐ 95% | 🟢 쉬움 | 단순 집계 |
| 4 | 실적집계 | ✅ 가능 | ⭐⭐⭐⭐⭐ 100% | 🟢 쉬움 | 직접 조회 가능 |
| 5 | 실적집계 | ✅ 가능 | ⭐⭐⭐⭐☆ 75% | 🔴 어려움 | 복잡한 계산 |
| 6 | 실적분석 | ✅ 가능 | ⭐⭐⭐⭐⭐ 95% | 🟡 보통 | 비교 로직 필요 |
| 7 | 실적분석 | ✅ 가능 | ⭐⭐⭐⭐☆ 85% | 🟡 보통 | 시점 비교 필요 |
| 8 | 실적분석 | 🟡 부분 가능 | ⭐⭐⭐⭐☆ 80% | 🟡 보통 | 그래프/사유는 제한적 |

### 범례
- **정확도**: API로 답변 가능한 정확도 수준
- **난이도**: 
  - 🟢 쉬움: 단일 API 조회로 해결 가능
  - 🟡 보통: 2~3개 API 조합 및 계산 필요
  - 🔴 어려움: 복잡한 다중 API 조회 및 복잡한 계산 로직 필요

---

## 🔧 공통 구현 고려사항

### 1. API 성능 최적화
- **페이징 활용**: 대량 데이터 조회 시 페이징 처리
- **필터링 최적화**: 필요한 필드만 조회하도록 파라미터 최적화
- **캐싱**: 자주 조회되는 데이터는 캐싱 고려

### 2. 에러 처리
- **데이터 부재**: 조회 결과가 없는 경우 적절한 메시지 제공
- **계산 예외**: 0으로 나누기 등의 예외 상황 처리
- **API 오류**: API 호출 실패 시 재시도 또는 대체 로직

### 3. 데이터 정합성
- **결산 완료 확인**: `pm_period_close` 테이블로 결산 완료 여부 확인
- **승인 상태 확인**: `approval_sts_cd=10` (승인) 데이터만 조회
- **최신 버전 선택**: 버전 관리 데이터의 최신 버전 선택 로직

### 4. 공통코드 활용
- **코드 변환**: `GET /api/common-codes`로 코드값을 읽기 쉬운 라벨로 변환
- **PBS 매핑**: PBS 코드를 대/중/소 분류명으로 변환
- **부서명 조회**: 부서코드를 부서명으로 변환

---

## 📝 결론

### ✅ 핵심 요약
1. **모든 질문이 API를 통해 답변 가능**합니다.
2. **질문 1, 3, 4, 6**은 높은 정확도(95~100%)로 구현 가능합니다.
3. **질문 2, 7**은 복합 조회 로직이 필요하지만 85% 정확도로 구현 가능합니다.
4. **질문 5**는 복잡한 집계 로직으로 인해 75% 정확도이며, 추가 검증이 필요합니다.
5. **질문 8**은 데이터 조회는 가능하나, 그래프 표현과 사유 분석은 프론트엔드 구현 또는 LLM 추론이 필요합니다.

### 🎯 권장사항
- **단계별 구현**: 쉬운 질문(1, 3, 4)부터 구현 후 복잡한 질문으로 확장
- **데이터 검증**: 각 API 응답 데이터를 실제 PMS 데이터와 비교 검증
- **공통 로직 모듈화**: 최신 버전 선택, 공통코드 변환 등의 공통 로직을 모듈화
- **LLM 활용**: 질문 8의 사유 분석 등 정성적 분석은 LLM을 활용한 추론 구현

---

**작성일**: 2025-11-06  
**작성 기준**: api.json, domain.md, glossary.txt, it-question-answered-1105.txt 분석 결과

